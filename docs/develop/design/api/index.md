# API文档

!!! Note "一般说明"

    在阅读具体的API前，请先阅读本部分，了解文档中的格式。

## 展示格式说明

- 接口部分将展示METHOD `path`，其中METHOD为允许的请求方法，`path`为相对路径。
- 说明部分将会具体阐释该API的功能。
- 参数部分将会列出该API所需的参数。在本项目中，所有的HTTP请求的所有参数都是必需的，而WebSocket请求中允许一部分参数缺失，详情请看Websocket请求的文档。
- 返回部分将列出该API请求成功的样例返回值与失败时的状态码。

## 返回体格式

!!! Note "若无特殊说明，返回体均为 `application/json`格式"

```json
{
  "code": JsonResponsecode,
  "info": info,
  "data": /* 其他字段 */
}
```

由于成功请求的 `code`字段一定为 `0`，`info`字段一定为 `Succeed`，故在展示成功请求的返回时，只展示**其他字段**。

## 通用异常返回值

为了节约篇幅，通用的异常返回值如下

| HTTP状态码 | 说明                                       |
| ---------- | ------------------------------------------ |
| 400        | 通用错误，具体错误由JsonResponse状态码决定 |
| 401        | 鉴权失败：用户未登陆                       |
| 405        | 请求方法不允许                             |
| 500        | 服务端其他内部错误                         |

## 鉴权认证

!!! warning "Token"

    在项目中，验证用户身份的方式是检查请求体中的`token`字段是否与已登录用户绑定。在接下来的API介绍中，每个有“需要登陆”标志的API都默认需要请求体中含有`token`字段，格式为

    ```json
    {
      "token": token
    }
    ```

    故在文档中，将`token`字段省略。请根据“需要登陆”标志判断请求体内是否需要`token`。

需要登陆的API会在介绍中有“需要登陆”的字样。由于本项目大部分API都需要用户登陆后才允许访问，故这里使用了 `django restframework`框架提供的鉴权方式，以便管理。
